---
layout: post
title:  "缓存-浏览器缓存"
date:   2020-03-19 17:55:56 +0800
categories: tech
---

浏览器缓存（Brower Caching）是指浏览器针对用户最近请求的资源进行缓存，以提高性能。当用户再次发起请求，浏览器将从本地直接加载资源。

<!-- more -->

## 优点

1. 提高加载速度：缓存离客户端更近，从缓存中加载资源比请求服务器用时更少。
2. 节省带宽使用：浏览器从本地获取数据，减少了冗余数据的传输。
3. 提升网站性能：缓存的使用削减了客户端请求服务器的次数，极大减少服务器压力，这样服务器就可以处理更多的请求。

## 分类

按照缓存位置可以将浏览器缓存划分为：Service Worker，Memory Cache，Disk Cache，Push Cache

- Service Worker
  Service Worker 是运行在浏览器背后的独立线程，一般可以用来实现缓存功能。它与浏览器其他内建的缓存机制不同，它可以让开发者自由控制缓存哪些文件、如何匹配缓存、如何读取缓存，并且缓存是持续性的。
- Memory Cache（内存缓存）
  存储于内存，一般是页面刷新时生效，这类型缓存是临时的但有很快的访问速度，当关闭页面时就会失效。
- Disk Cache（硬盘缓存）
  存储于硬盘，当重新打开页面时生效，相比于内存缓存有更长的存储周期，不会在关闭页面时失效。而且在跨站点情况下，已缓存的Disk Cache也会生效。与Disk Cache相关的控制头部在下面介绍。
- Push Cache（推送缓存）
  推送缓存是针对HTTP/2标准下的推送资源设定的。推送缓存是和session绑定的，当session关闭，缓存也会同时失效。

## 过程

<img src="http://kcoder-web.oss-cn-shenzhen.aliyuncs.com/img/20200323001.jpg" alt="缓存过程" width="80%" height="80%">

## 策略

- 强制缓存

  使用强制缓存时，浏览器不会向服务器发送请求，直接从缓存中读取资源。

  强缓存可以通过设置HTTP响应头**Expires 和 Cache-Control**控制。

  

- 协商缓存

  协商缓存是在强制缓存失效后，浏览器会携带缓存标识向服务器发起请求，由服务器决定是否使用缓存。浏览器根据缓存标识和资源比较，返回资源未更新（304状态码）或者新的资源。

  和协商缓存相关的HTTP头部包括Last-Modified和If-Modified-Since，ETag和If-None-Match

## 相关阅读

[深入理解浏览器缓存机制-简书](https://www.jianshu.com/p/54cc04190252)

[](https://www.zhangxinxu.com/wordpress/2013/05/caching-tutorial-for-web-authors-and-webmasters/)

[扒一扒浏览器缓存机制-知乎](https://zhuanlan.zhihu.com/p/56943873)

[浏览器缓存：强缓存和协商缓存](https://www.cnblogs.com/iceflorence/p/8905825.html)

[Cache-Control-MDN](https://developer.mozilla.org/zh-CN/docs/Web/HTTP/Headers/Cache-Control)

[HTTP/1.1 缓存协议](https://tools.ietf.org/html/rfc7234)