---
layout: post
title:  "消息中间件简介"
date:   2020-03-30 10:30:40 +0800
categories: tech
---

## 常见消息中间件

- [ ] Activemq
- [ ] Rabbitmq
- [ ] Kafka
- [ ] Rocketmq

## 什么是消息中间件

利用高效可靠的消息传递机制进行平台无关的数据交流，并基于数据通信来进行分布式系统集成。通过提供消息传递和消息排队模型，可以在分布式环境下扩展进程的通信。

本质上是一种具备接受请求，保存数据和发送数据等功能的网络应用。和一般网络应用的区别是，它主要负责消息的接受和传递，所以性能要高于一般应用

## 使用场景

跨系统数据传递，高并发流量削峰，数据异步处理

## 协议

协议是计算机通信时共同遵守的一组约定，都遵守相同约定，计算机才能相互交流

协议三要素：语法、语义、时序

消息中间件常用协议

- AMQP(Advanced Message Queuing Protocol)

  高级消息队列协议，04年JPMorgan Chase（摩根大通集团）联合其他公司共同设计。

  特性：事务支持、持久化支持，出生金融行业，在可靠消息处理上具有天然优势。

- MQTT(Message Queuing Telemetry Transport)

  消息队列遥测传输是IBM开发的一个即时通讯协议，物联网架构中重要组成部分。

  特性：轻量、结构简单、传输快、没有事务支持、没有持久化相关支持。

- OPEN MESSAGE

  OPEN MESSAGE是由阿里发起，与雅虎、滴滴、streamlio等公司共同参与创立的分布式消息中间件、流处理的应用开发标准。是国内首个在全球范围内发起的分布式消息邻域国际标准。

  特性：结构简单、解析快、有事务设计、有持久化设计

- Kafka

  Kafka协议是基于TCP的二进制协议。消息内部是通过长度来分割，由一些基本数据类型组成

  特性：结构简单、解析快、无事务设计、有持久化设计

## 持久化

| 持久化   | Activemq | Rabbitmq | Kafka | Rocketmq |
| -------- | :------: | :------: | :---: | :------: |
| 文件系统 |    √     |    √     |   √   |    √     |
| 数据库   |    √     |    -     |   -   |    -     |



## 分发策略

| 分发策略 | Activemq | Rabbitmq | Kafka | Rocketmq |
| -------- | :------: | :------: | :---: | :------: |
| 发布订阅 |    √     |    √     |   √   |    √     |
| 轮询分发 |    √     |    √     |   √   |    -     |
| 公平分发 |    -     |    √     |   √   |    -     |
| 重发     |    -     |    √     |   -   |    √     |
| 消息拉取 |    -     |    √     |   √   |    √     |

## 消息可靠

在高并发业务场景下，如果不能保证系统高可靠，那将造成非常严重损失。为保证消息中间件的高可靠，可以从下面几个方面考虑

- 消息传输可靠：通过协议来保证系统之间解析数据的可靠性
- 消息存储可靠：通过持久化来保证消息存储的可靠性